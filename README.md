# FaceMaskDetection

A YOLOv8-based deep learning model for detecting three classes of face mask usage: with_mask, without_mask, and mask_weared_incorrect. The model was trained on a labeled dataset of face images and optimized for object detection tasks.

---

## Project Overview

This project identifies whether a person is wearing a mask correctly, incorrectly, or not wearing a mask. The model is trained using the YOLOv8 architecture on a dataset containing 4,072 labeled instances.

---

## Repository Structure

```
FaceMaskDetection/
├── annotations/        # XML annotation files (Pascal VOC format)
├── images/             # Training & validation images
├── labels/             # YOLO-format label files (.txt)
├── runs/               # YOLOv8 training outputs (plots, weights, results)
├── mask.yaml           # Dataset configuration file
├── yolov8n.pt          # Pretrained YOLOv8n model used for training
├── try.jpg             # Example test image for inference
├── archive.zip         # Original dataset archive
├── labels.cache        # Cache auto-generated by YOLO
└── README.md           # Project documentation
```

---

## Installation

### 1. Clone the repository
```bash
git clone https://github.com/DAlal1smss/FaceMaskDetection.git
```

### 2. Install required dependencies
```bash
pip install ultralytics
pip install lxml
```

---

## Dataset Preparation

The dataset used in this project is the Face Mask Detection dataset downloaded from Kaggle.

It contains 853 images belonging to three classes: with_mask, without_mask, mask_weared_incorrect.

The dataset was originally provided in Pascal VOC (XML) format, and the annotations were converted into YOLO format (.txt) before training.

Dataset folder structure:
```
images/        # All training & validation images
annotations/   # Original XML annotation files
labels/        # YOLO-format label files generated from XML
mask.yaml      # Dataset configuration file for YOLOv8
```

This structure is required for YOLOv8 training.

---

## Training Command

```python
from ultralytics import YOLO

model = YOLO("yolov8n.pt")
model.train(
    data="mask.yaml",
    epochs=20,
    imgsz=416,
    batch=16
)
```

---

## Example Inference

```python
from ultralytics import YOLO

model = YOLO("runs/detect/train2/weights/best.pt")
model.predict(source="try.jpg")
```

---

## How to Run the Model

```python
from ultralytics import YOLO

model = YOLO("runs/detect/train2/weights/best.pt")
results = model.predict(source="path_to_image.jpg")
```

---
## Code Quality & Execution
The project code is fully functional and runs without errors when executed in order inside the provided Google Colab notebook.
The notebook is organized into clear steps, including:

Extracting the dataset and preparing the directory structure

Converting Pascal VOC XML annotations into YOLO-format labels using a custom Python script

Creating the mask.yaml configuration file

Installing required dependencies (Ultralytics, lxml)

Training the YOLOv8n model for 20 epochs

Running inference on test images and saving predictions

The code is clean, modular, and well-commented, making it easy to follow and reproduce.

## Originality & Contribution
This project includes original implementation beyond standard tutorials.
The key unique contributions are:

A custom Python script to convert XML annotations (Pascal VOC) into YOLO label format

Manual preparation of the dataset structure for YOLOv8 training

Creating a complete end-to-end training pipeline inside Google Colab (extraction → conversion → training → inference)

Using a custom-configured mask.yaml file tailored for the three mask classes

These steps demonstrate meaningful implementation, modification, and independent contribution beyond existing online resources.

## Results

The model was trained for 20 epochs using YOLOv8n.

Key performance outcomes include:
- Successful detection of all three mask classes  
- Clear bounding boxes and confidence scores  
- Stable training curves with decreasing loss  

Training outputs (loss curves, confusion matrix, mAP plots) are stored automatically inside:
```
runs/detect/train2/
```

---

## License

Dataset: CC0 Public Domain (Kaggle license)  
YOLOv8: AGPL-3.0 License (Ultralytics)
